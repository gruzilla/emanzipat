!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class n{constructor(){this.valid=!1,this.id=null,this.data=null;let[,t,e]=window.location.href.match(n.URL_PATTERN)||[];if(void 0!==t&&void 0!==e){this.id=t;try{this.data=JSON.parse(decodeURIComponent(e))}catch(t){return console.error("https://github.com/gruzilla/emanzipat/blob/master/codes.md#silo.invalid",t),void(this.valid=!1)}this.data.hasOwnProperty("d")&&this.data.hasOwnProperty("s")&&this.data.d.hasOwnProperty("l")&&this.data.d.hasOwnProperty("v")&&this.data.d.hasOwnProperty("id")||(console.error("https://github.com/gruzilla/emanzipat/blob/master/codes.md#silo.invalid"),this.valid=!1),this.valid=!0}else this.valid=!1}static getInitializationUrl(t,e){let i=n.generateId();return console.info("https://github.com/gruzilla/emanzipat/blob/master/codes.md#initialized"),console.debug(i,t,e),"/silo/"+i+"/"+encodeURIComponent(JSON.stringify(this.wrapSettings(i,t,e)))}static getUrl(t){return console.info("https://github.com/gruzilla/emanzipat/blob/master/codes.md#updated"),"/silo/"+t.getId()+"/"+encodeURIComponent(JSON.stringify(this.wrapSettings(t.getId(),t.getName(),t.getSettings())))}static generateId(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}static wrapSettings(t,e,i){return{d:{v:n.VERSION,id:t,l:e},s:i}}isValid(){return this.valid}getId(){return this.id}getSettings(){return this.data.s}getLoaderName(){return this.data.d.l}}n.VERSION=0,n.URL_PATTERN=/\/silo\/([^/]+)\/([^/]+)/i;class o{constructor(t,e){this.id=t,this.settings=e}render(){return this.settings.hasOwnProperty("d")?'<div id="urlSiloData" contenteditable="true">'+this.settings.d+"</div>":(console.error("https://github.com/gruzilla/emanzipat/blob/master/codes.md#urlSilo.noData"),"ERROR. See console.")}save(){this.settings.d=document.getElementById("urlSiloData").innerHTML}getId(){return this.id}getName(){return o.NAME}getSettings(){return this.settings}}o.NAME="url",o.DEFAULT_SETTINGS={d:"拜托, chänge moi (:"};class a{constructor(t,e){this.id=t,this.settings=e}render(){let t=localStorage.getItem(this.id);return t||(t=a.DEFAULT_DATA),'<div id="urlSiloData" contenteditable="true">'+t+"</div>"}save(){localStorage.setItem(this.id,document.getElementById("urlSiloData").innerHTML)}getId(){return this.id}getName(){return a.NAME}getSettings(){return this.settings}}a.NAME="localStorage",a.DEFAULT_SETTINGS={},a.DEFAULT_DATA="拜托, chänge moi (:";class r{constructor(t,e){this.barId=t,this.silo=e,this.render()}render(){document.getElementById(this.barId).innerHTML='<div class="buttons"><button id="emanzibarNew">new</button><button id="emanzibarSave">save</button></div>',document.getElementById("emanzibarSave").addEventListener("click",this.save.bind(this)),document.getElementById("emanzibarNew").addEventListener("click",this.new.bind(this))}save(){this.silo.save(),window.location.href=n.getUrl(this.silo)}new(){window.location.href=n.getInitializationUrl()}}class s{constructor(t,e){this.contentId=t,this.barId=e,this.silo=null;let i=new n;if(i.isValid())return this.loadSilo(i.getLoaderName(),i.getId(),i.getSettings()),void this.loadBar();this.showCreateSilo()}showCreateSilo(){let t=document.getElementById(this.contentId);t.innerHTML='<h1>welcome to emanzip.at</h1><p><a href="https://github.com/gruzilla/emanzipat">read me</a><p><button id="createUrlSilo">create new URL silo</button></p><p><button id="createLocalStorageSilo">create new LocalStorage silo</button></p>',t.classList.add("init"),document.getElementById("createUrlSilo").addEventListener("click",function(){s.createSilo("url")}),document.getElementById("createLocalStorageSilo").addEventListener("click",function(){console.log("blub!"),s.createSilo("localStorage")})}static createSilo(t){switch(t){case"localStorage":window.location.href=n.getInitializationUrl(a.NAME,a.DEFAULT_SETTINGS);break;default:window.location.href=n.getInitializationUrl(o.NAME,o.DEFAULT_SETTINGS)}}loadSilo(t,e,i){switch(this.silo=null,t){case"localStorage":this.silo=new a(e,i);break;default:this.silo=new o(e,i)}let n=document.getElementById(this.contentId);n.innerHTML=this.silo.render(),n.classList.remove("init"),n.classList.add(t),console.info("https://github.com/gruzilla/emanzipat/blob/master/codes.md#rendered")}loadBar(){new r(this.barId,this.silo)}}new s("main","emanzibar")}]);